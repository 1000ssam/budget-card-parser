# HANDOVER: 사업관리카드 파서 웹앱

## 프로젝트 개요
학교 현장에서 사용하는 사업관리카드(예산) .xls/.xlsx 파일을 업로드하면, 들여쓰기로 병합된 "세부사업/세부항목/원가통계비목" 컬럼을 자동 분리하여 정규화된 테이블로 보여주는 웹앱.

## 현재 상태
- **구현 계획 완료** (`PLAN.md` 참조)
- **코드 작성 미시작** — Next.js 프로젝트 초기화부터 해야 함
- `read_xls_full.mjs`: 샘플 파일 분석용 임시 스크립트 (삭제 가능)
- `package.json`: xlsx만 devDependency로 설치된 상태 (Next.js init 시 덮어쓸 것)

## 작업 디렉토리
`C:\dev\budget-card-parser\`

## 샘플 파일
`C:\Users\user\Downloads\복사본 사업관리카드(예산)_20230619 현재.xls`

## 핵심 분석 결과 (샘플 파일)

### 파일 구조
- 시트 1개: `사업관리카드(예산)`
- 범위: A1:I43 (43행 x 9열)
- 헤더: 2행 병합 구조 (Row 2~3)

### 들여쓰기 패턴 (A열)
| 선행 공백 수 | 레벨 | 의미 |
|-------------|------|------|
| 1 | 0 | 합계 |
| 4 | 1 | 세부사업 |
| 7 | 2 | 세부항목 |
| 10 | 3 | 원가통계비목 (실 데이터) |

### 컬럼 구성 (이 파일 기준)
A: 세부사업/세부항목/원가통계비목 (병합), B: 산출내역, C: 예산현액(A), D: 지출품의금액, E: 원인행위금액(B), F: 집행률(B/A), G: 지출결의금액, H: 지급액, I: 예산잔액(A-B)

### 파일 간 변동 사항
- 컬럼 구성은 파일마다 다를 수 있음
- A열의 들여쓰기 기반 계층 구조만 동일

## 기술 스택 (확정)
- Next.js 14+ (App Router) + TypeScript
- SheetJS (xlsx): 클라이언트 사이드 파싱
- Tailwind CSS
- Vercel 배포

## 기능 요구사항 (확정)
1. 드래그앤드롭 + 클릭 파일 업로드
2. 파싱 결과 테이블 미리보기 (세부사업/세부항목/비목 분리)
3. 셀 범위 드래그 선택 → 복사
4. 전체 복사 버튼 (TSV → 엑셀 붙여넣기 호환)
5. 정규화된 xlsx 다운로드

## 다음 세션에서 할 일
1. `npx create-next-app@latest` 으로 Next.js 프로젝트 초기화
2. `PLAN.md`의 파일 구조대로 구현
3. 파싱 로직 (`src/lib/parser.ts`) 구현 — 핵심
4. UI 컴포넌트 구현
5. 샘플 파일로 테스트
6. Vercel 배포
